CREATE TABLE labs(
	labid INTEGER PRIMARY KEY AUTOINCREMENT, 
	labname VARCHAR(255), 
	active INTEGER, 
	lab_info VARCHAR(1024)
);

CREATE TABLE users (
	username VARCHAR(50) NOT NULL UNIQUE PRIMARY KEY, 
	password VARCHAR(255) NOT NULL, 
	created_at DATETIME DEFAULT CURRENT_TIMESTAMP 
);

CREATE TABLE operating_systems(
	name VARCHAR(255) NOT NULL UNIQUE PRIMARY KEY, 
	file_location VARCHAR(255) NOT NULL
);

CREATE TABLE labs_os(
	labid INTEGER, 
	os_name VARCHAR(255), 
	FOREIGN KEY (labid) REFERENCES labs(labid) ON DELETE CASCADE, 
	FOREIGN KEY (os_name) REFERENCES operating_systems(name) ON DELETE CASCADE
);

CREATE TABLE users_labs(
	username VARCHAR(255), 
	labid INTEGER, 
	FOREIGN KEY (username) REFERENCES users(username) ON DELETE CASCADE, 
	FOREIGN KEY (labid) REFERENCES labs(labid) ON DELETE CASCADE, 
	PRIMARY KEY ( username, labid)
);



CREATE TABLE lab_vmids(
	username VARCHAR(255), 
	labid INTEGER, 
	vm_id VARCHAR(255), 
	os_name VARCHAR(255), 
	FOREIGN KEY (username, labid) REFERENCES users_labs(username, labid) ON DELETE CASCADE
);

INSERT INTO lab_vmids (username, labid, vm_id, os_name) VALUES ("admin", '23', "2dd2w1s", "asdasd");


